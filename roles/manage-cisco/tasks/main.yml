- name: gather router facts
  ios_facts:
    ssh_keyfile: "{{ playbook_dir }}/workshops/{{ name_prefix }}/{{ skylight_user }}-{{ name_prefix }}-private.pem"

# - name: grab facts for rtr1
#   ec2_instance_facts:
#     region: "{{ ec2_region }}"
#     filters:
#       instance-state-name: running
#       "tag:Name": "{{ec2_name_prefix}}-{{username}}-rtr1"

- name: display version
  debug:
    msg: "The IOS version is: {{ ansible_net_version }}"

- name: display serial number
  debug:
    msg: "The serial number is:{{ ansible_net_serialnum }}"

- name: create a new user
  ios_user:
    name: nici
    configured_password: ansible
    state: present

- name: check the startup-config against the running-config
  ios_config:
    diff_against: startup
    diff_ignore_lines:
      - ntp clock .*

- name: ensure that the desired snmp strings are present
  ios_config:
    backup: yes
    commands:
      - snmp-server community ansible-public RO
      - snmp-server community ansible-private RW
      - snmp-server community ansible-test RO
