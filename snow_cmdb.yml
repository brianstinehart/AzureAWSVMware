---
- name: Snow Notification
  hosts: all
  connection: local
  gather_facts: no
  
  tasks:

    - name: Show all hosts
      debug:
        msg: "{{ item }}"
      loop: "{{ ansible_play_batch }}"

    - name: Update ServiceNow CMDB
      snow_record:
        username: "{{ snow_username }}"
        password: "{{ snow_password }}"
        instance: "{{ snow_instance }}"
        state: present
        table: cmdb_ci_linux_server
        lookup_field: comments
        number: "9f10a050-56cd-46f7-8f76-a0ff9ad0e29c"
        data: 
          asset_tag: EA-s1-WebServer
          cost_center: Engineering
          os_version: 7.5.201808150
          location: australiasoutheast
          mac_address: 00-22-48-D3-EB-F5
          short_description: Provisioned for EA demo
          comments: "9f10a050-56cd-46f7-8f76-a0ff9ad0e29c"
          change_control: Project Mgmt
          os: Linux Red Hat
          model_id: Iris 5875
          ip_address: "{{ ansible_host }}"
      register: snow_var